# Project Overview

This project implements a multi-threaded application using an RTOS to control various hardware components, including SPI communication, LED flashing, button interaction, and audio output. The application consists of several threads, each responsible for different functionalities:

<div align="center">

  [Video](https://github.com/ameer-alwadiya/real-time-accelerometer/assets/127532790/6cc7d629-e0c4-475f-80cb-ad1b9a40a2fe)

</div>

- **SPI Thread**: Initializes SPI communication and handles data transmission.
- **LED Flasher Thread**: Controls LED flashing patterns.
- **Button Thread**: Manages button interactions to control which thread is active.
- **I2C and I2S Thread**: Handles audio output through I2S and I2C interfaces.

## Levels of Implementation

### Level 1 - Creating a Dynamic Two-Axis Tilt Switch Interface

1. **SPI Parameters Struct**:
   - Defined in `my_headers.h`, the `SPI_Params_Init` struct holds SPI initialization parameters, including pointers to track changes.

2. **SPI Thread**:
   - Implemented in `Thread.c` as `SPI_Thread`. Initializes and manages SPI communication.
   - The thread is started with `osSignalSet(tid_SPI_Thread, 0x01)` and waits for a signal with `osSignalWait(0x01, osWaitForever)`.

3. **Tilt Switch Interface**:
   - Reads X and Y axis data from the LIS3DSH sensor.
   - Sensitivity is set to Â±500. LEDs are controlled based on tilt direction and threshold values.

### Level 2 - Control with Push Button

1. **Button and Blinking Threads**:
   - Implemented in `Thread.c` as `Button_Thread` and `Blink_Thread`.
   - `Blink_Thread` handles LED blinking for 0.5 seconds.

2. **Button Control**:
   - The button acts as a latch switch using a global variable `flag`.
   - Clicking the button toggles between different functions:
     - **Flag = 0**: Turns on all LEDs for one second and starts the blinking, I2C, and I2S threads.
     - **Flag = 1**: Adds a 200ms debounce delay and reverts to SPI thread while clearing other thread flags.

### Level 3 - Generating a Beep Sound using CS43L22

1. **I2C and I2S Parameters Struct**:
   - Similar to Level 1, struct created to hold initialization parameters for I2C and I2S interfaces.

2. **CS43L22 Initialization**:
   - Configured using `HAL_I2C_Master_Transmit` to set registers for audio output.
   - Beep sound generated by writing to the appropriate registers in the CS43L22 DAC.

3. **I2C and I2S Thread**:
   - Implemented in `Thread.c` as `I2C_I2S_Thread`.
   - Handles audio data transmission using `HAL_I2S_Transmit_IT`.

## Files

- **`Thread.c`**: Contains implementations of various threads.
- **`Thread.h`**: Header file for thread declarations.
- **`main.c`**: Main entry point of the application.
- **`my_headers.c`**: Implementation of additional utility functions.
- **`my_headers.h`**: Header file for additional utility functions and structs.
- **`osObjects.h`**: Contains RTOS object definitions.
- **`Report.pdf`**: UML diagram and detailed report of the project.

## Getting Started

1. **Setup**: Ensure you have the necessary RTOS and hardware dependencies.
2. **Compile**: Use your preferred build system to compile the project.
3. **Upload**: Flash the compiled binary to your hardware.


For any questions or support, please contact ameer.alwadiya@outlook.com.


